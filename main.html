<html>
  <head>
    <title>John Cena!</title>
    <script type="text/javascript" src="elm.js"></script>
    <link rel="stylesheet" type="text/css" href="styles.css">

	</head>

	<body background="resources/background.jpg">

	  <h1 align="center">Procedural-functional-elm-haskell-lambda-cena-shooter game</h1>

    <div id="selectName">
      <form>
        Player name: <input id="nameField" type="text" name="playerName" pattern="[A-Za-z0-9]{3,}" required="required">
        <input type="button" onclick="showMenu()" value="Enter">
      </form>
      <div style="overflow: auto">
        Your name must be composed of letters and/or numbers with at least 3 characters.
      </div>
    </div>

		<div id="mainMenu">
			<ul>
				<button type=button onclick="startGame()">Start Game</button>
				<button type=button onclick="startGame()">Choose Server</button>
				<button type=button onclick="startGame()">Settings</button>
			</ul>
		</div>

    <div id="game" unselectable="on" onselectstart="return false;" onmousedown="return false;"/>

    <script src="http://code.jquery.com/jquery-2.2.2.min.js"></script>
    <script src="http://jqueryvalidation.org/files/dist/jquery.validate.min.js"></script>
    <script src="http://jqueryvalidation.org/files/dist/additional-methods.min.js"></script>
    <script type="text/javascript">
      function showMenu() {
        if ($("#nameField")[0].checkValidity()) {
          document.getElementById("selectName").style.display = "none";
          document.getElementById("mainMenu").style.display = "block";
        }
      }

  		function startGame() {
      	var div = document.getElementById("game");
  			Elm.embed(Elm.Main, div, { playerName: document.getElementById('nameField').value });

  			document.getElementById("mainMenu").style.display = "none";
  			div.style.display = "block";
  		}

  		document.onkeydown = handleKeyPress;
  		function handleKeyPress(e)
  		{
  			var key=e.keyCode;
        //escape key
    		if (key==27) {
  				var menu = document.getElementById("mainMenu").style;
  				if(menu.display == "block") {
  					menu.display = "none";
  					menu.opacity = 0.7;
            window.onclick = none;
  				}
  			else {
  					menu.display = "block";
  					menu.opacity = 0.7;
  			}
    	}
  	}
    //Disable backspace
    $(document).unbind('keydown').bind('keydown', function (event) {
    var doPrevent = false;
    if (event.keyCode === 8) {
        var d = event.srcElement || event.target;
        if ((d.tagName.toUpperCase() === 'INPUT' &&
             (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' ||
                 d.type.toUpperCase() === 'FILE' ||
                 d.type.toUpperCase() === 'SEARCH' ||
                 d.type.toUpperCase() === 'EMAIL' ||
                 d.type.toUpperCase() === 'NUMBER' ||
                 d.type.toUpperCase() === 'DATE' )
             ) ||
             d.tagName.toUpperCase() === 'TEXTAREA') {
            doPrevent = d.readOnly || d.disabled;
        }
        else {
            doPrevent = true;
        }
    }

    if (doPrevent) {
        event.preventDefault();
    }
});
    </script>
  </body>
</html>
